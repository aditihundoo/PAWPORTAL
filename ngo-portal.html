<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NGO Portal - PawPortal</title>
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #f97316;
            --accent-color: #ef4444;
            --light-bg: #f9f9ff;
            --dark-text: #1e293b;
            --light-text: #ffffff;
            --gradient-primary: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
            --gradient-secondary: linear-gradient(135deg, #f97316 0%, #fb923c 100%);
            --gradient-accent: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
            --section-bg: rgba(255, 255, 255, 0.98);
            --card-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --border-radius: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        body {
            background-color: var(--light-bg);
            color: var(--dark-text);
            font-family: 'Poppins', 'Arial', sans-serif;
            margin: 0;
            min-height: 100vh;
        }
        .portal-header {
            background: var(--gradient-primary);
            color: var(--light-text);
            padding: 2.5rem 0 1.5rem 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            border-bottom-left-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
        }
        .portal-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
        }
        .portal-header p {
            color: #e0e7ff;
            font-size: 1.15rem;
        }
        .portal-nav {
            background: var(--gradient-secondary);
            display: flex;
            justify-content: center;
            gap: 2rem;
            padding: 1.2rem 0;
            box-shadow: 0 2px 8px rgba(249, 115, 22, 0.08);
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }
        .portal-nav a {
            color: var(--light-text);
            text-decoration: none;
            font-weight: 600;
            padding: 0.7rem 2rem;
            border-radius: 50px;
            font-size: 1.1rem;
            transition: var(--transition);
            position: relative;
        }
        .portal-nav a:hover, .portal-nav a.active {
            background: var(--gradient-primary);
            color: #fff;
            box-shadow: var(--card-shadow);
        }
        .portal-main {
            max-width: 1000px;
            margin: 3rem auto;
            background: var(--section-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            padding: 3rem 2.5rem;
            text-align: center;
        }
        .portal-main h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 2rem;
        }
        .portal-main p {
            font-size: 1.15rem;
            color: #475569;
            margin-bottom: 2rem;
        }
        .portal-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
        }
        .portal-action {
            background: var(--gradient-primary);
            color: var(--light-text);
            border-radius: var(--border-radius);
            padding: 2.2rem 2.8rem;
            min-width: 220px;
            box-shadow: var(--card-shadow);
            font-size: 1.15rem;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
        }
        .portal-action:hover {
            transform: translateY(-8px) scale(1.04);
            box-shadow: var(--hover-shadow);
            background: var(--gradient-secondary);
            color: #fff;
        }
        .portal-section {
            margin-top: 2rem;
        }
        form {
            background: #f8fafc;
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(44,62,80,0.08);
            margin: 0 auto;
        }
        input, textarea, select, button {
            font-family: inherit;
        }
        input[type="text"], input[type="number"], input[type="email"], input[type="tel"], textarea {
            width: 100%;
            padding: 0.9rem;
            border-radius: 12px;
            border: 1.5px solid #e2e8f0;
            font-size: 1rem;
            margin-bottom: 1.2rem;
            transition: var(--transition);
            background: #fff;
        }
        input:focus, textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.08);
            outline: none;
        }
        button[type="submit"], button, .portal-action {
            cursor: pointer;
            background: var(--gradient-primary);
            color: #fff;
            border: none;
            border-radius: 50px;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        button[type="submit"]:hover, button:hover {
            background: var(--gradient-secondary);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            background: #fff;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        th, td {
            padding: 1rem;
            text-align: left;
        }
        th {
            background: var(--gradient-primary);
            color: #fff;
            font-weight: 600;
            border-bottom: 2px solid #e2e8f0;
        }
        tr:nth-child(even) {
            background: #f3f4f6;
        }
        tr:hover {
            background: #ede9fe;
        }
        img {
            border-radius: 12px;
        }
        .success-message {
            color: #10b981;
            background: #e0f7ef;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1.2rem;
            font-weight: 600;
            display: inline-block;
        }
        @media (max-width: 900px) {
            .portal-main {
                padding: 2rem 0.5rem;
            }
            .portal-actions {
                flex-direction: column;
                gap: 1.2rem;
            }
        }
        @media (max-width: 600px) {
            .portal-header h1 {
                font-size: 1.5rem;
            }
            .portal-main h2 {
                font-size: 1.2rem;
            }
            .portal-action {
                padding: 1.2rem 1.5rem;
                font-size: 1rem;
            }
            th, td {
                padding: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="portal-header">
        <h1 id="ngoName">Welcome to NGO Portal</h1>
        <p>Please login to access your NGO dashboard</p>
    </div>
    <nav class="portal-nav">
        <a href="#" class="active" data-section="login">Login</a>
        <a href="#" data-section="register">Register</a>
        <a href="user.html">Back to Home</a>
    </nav>
    <main class="portal-main">
        <section id="login-section" class="portal-section">
            <h2>NGO Login</h2>
            <form id="loginForm" style="max-width: 400px; margin: 0 auto;">
                <input type="email" id="loginEmail" placeholder="Email" required />
                <input type="password" id="loginPassword" placeholder="Password" required />
                <div id="loginError" style="color: red; margin-bottom: 1rem;"></div>
                <button type="button" onclick="login()">Login</button>
            </form>
        </section>

        <section id="register-section" class="portal-section" style="display: none;">
            <h2>Register NGO</h2>
            <form id="registerForm" style="max-width: 400px; margin: 0 auto;">
                <input type="text" id="orgName" placeholder="Organization Name" required />
                <input type="email" id="email" placeholder="Email" required />
                <input type="password" id="password" placeholder="Password" required />
                <div id="error" style="color: red; margin-bottom: 1rem;"></div>
                <button type="submit">Sign Up</button>
            </form>
        </section>

        <section id="dashboard-section" class="portal-section" style="display: none;">
            <h2>NGO Dashboard</h2>
            <p>Use the options below to manage your organization's dogs and adoption process. More features coming soon!</p>
            <div class="portal-actions">
                <a href="#" class="portal-action" data-section="add-dog">Add a New Dog</a>
                <a href="#" class="portal-action" data-section="manage-dogs">View & Edit Dogs</a>
                <a href="#" class="portal-action" data-section="adoption-requests">View Adoption Requests</a>
                <a href="#" class="portal-action" data-section="update-info">Update Organization Info</a>
            </div>
        </section>
        <section id="add-dog-section" class="portal-section" style="display: none;">
            <h2>Add a New Dog</h2>
            <form id="dogForm">
                <input type="text" id="dogName" placeholder="Dog Name" required />
                <input type="text" id="breed" placeholder="Breed" required />
                <input type="number" id="age" placeholder="Age (in years)" min="0" step="0.1" required />
                <input type="number" id="weight" placeholder="Weight (in kg)" min="0" step="0.1" required />
                <textarea id="healthStatus" placeholder="Health Status (e.g., Vaccinated, Spayed/Neutered, Any medical conditions)" rows="3" required></textarea>
                <input type="file" id="imageInput" accept="image/*" required />
                <button type="submit">Upload Dog Info</button>
            </form>
        </section>
        <section id="manage-dogs-section" class="portal-section" style="display:none">
            <h2>Manage Dogs</h2>
            <div style="overflow-x:auto;">
                <table id="dogsTable" style="width:100%; border-collapse:collapse; margin-top:1.5rem;">
                    <thead>
                        <tr style="background:#f4f6f8;">
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Image</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Name</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Age</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Breed</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Health Description</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dog rows will be inserted here by JS -->
                    </tbody>
                </table>
            </div>
        </section>
        <section id="adoption-requests-section" class="portal-section" style="display:none">
            <h2>Adoption Requests</h2>
            <div style="overflow-x:auto;">
                <table id="adoptionRequestsTable" style="width:100%; border-collapse:collapse; margin-top:1.5rem;">
                    <thead>
                        <tr style="background:#f4f6f8;">
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Requester Name</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Dog Name</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Contact</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Status</th>
                            <th style="padding:0.7rem; border-bottom:1px solid #ddd;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Requests will be inserted here by JS -->
                    </tbody>
                </table>
            </div>
        </section>
        <section id="update-info-section" class="portal-section" style="display:none">
            <h2>Update Organization Info</h2>
            <form id="orgInfoForm" style="max-width: 500px; margin: 0 auto; background: #f8f9fa; padding: 2rem 2rem 1rem 2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(44,62,80,0.08);">
                <div style="margin-bottom: 1.2rem;">
                    <label for="orgName" style="display:block; font-weight:600; margin-bottom:0.4rem;">Organization Name</label>
                    <input type="text" id="orgName" name="orgName" required style="width:100%; padding:0.6rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom: 1.2rem;">
                    <label for="orgEmail" style="display:block; font-weight:600; margin-bottom:0.4rem;">Email</label>
                    <input type="email" id="orgEmail" name="orgEmail" required style="width:100%; padding:0.6rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom: 1.2rem;">
                    <label for="orgPhone" style="display:block; font-weight:600; margin-bottom:0.4rem;">Phone</label>
                    <input type="tel" id="orgPhone" name="orgPhone" required style="width:100%; padding:0.6rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom: 1.2rem;">
                    <label for="orgAddress" style="display:block; font-weight:600; margin-bottom:0.4rem;">Address</label>
                    <input type="text" id="orgAddress" name="orgAddress" required style="width:100%; padding:0.6rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom: 1.2rem;">
                    <label for="orgDescription" style="display:block; font-weight:600; margin-bottom:0.4rem;">Description</label>
                    <textarea id="orgDescription" name="orgDescription" rows="3" required style="width:100%; padding:0.6rem; border-radius:6px; border:1px solid #ccc;"></textarea>
                </div>
                <button type="submit" style="width:100%; padding:0.8rem; background: var(--primary-color); color:#fff; border:none; border-radius:6px; font-size:1.1rem; font-weight:600; cursor:pointer; transition:background 0.2s;">Save</button>
            </form>
            <div class="success-message" id="orgSuccessMessage" style="display:none; color:green; text-align:center; margin-top:1.2rem;">
                Organization info updated successfully!
            </div>
        </section>
    </main>
    <!-- Modal for editing dog details -->
    <div id="editDogModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:2rem; border-radius:12px; max-width:400px; width:90%; position:relative;">
            <h3>Edit Dog</h3>
            <form id="editDogForm">
                <input type="hidden" id="editDogId">
                <div style="margin-bottom:1rem;">
                    <label for="editDogName" style="font-weight:600;">Name</label>
                    <input type="text" id="editDogName" required style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom:1rem;">
                    <label for="editDogAge" style="font-weight:600;">Age</label>
                    <input type="number" id="editDogAge" min="0" required style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom:1rem;">
                    <label for="editDogBreed" style="font-weight:600;">Breed</label>
                    <input type="text" id="editDogBreed" required style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom:1rem;">
                    <label for="editDogHealth" style="font-weight:600;">Health Description</label>
                    <input type="text" id="editDogHealth" style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="margin-bottom:1rem;">
                    <label for="editDogImage" style="font-weight:600;">Image URL</label>
                    <input type="text" id="editDogImage" style="width:100%; padding:0.5rem; border-radius:6px; border:1px solid #ccc;">
                </div>
                <div style="text-align:right;">
                    <button type="button" onclick="closeEditModal()" style="margin-right:0.5rem; padding:0.5rem 1rem; border:none; background:#ccc; color:#333; border-radius:4px; cursor:pointer;">Cancel</button>
                    <button type="submit" style="padding:0.5rem 1rem; border:none; background:#1976d2; color:#fff; border-radius:4px; cursor:pointer;">Save</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Firebase Core SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>

    <!-- Firebase Auth SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <!-- Firestore SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA2zAdnwkms_F-lVWZnA9q-4t_f014CkZQ",
            authDomain: "paw-portal-f651d.firebaseapp.com",
            projectId: "paw-portal-f651d",
            storageBucket: "paw-portal-f651d.firebasestorage.app",
            messagingSenderId: "178766672520",
            appId: "1:178766672520:web:123d27c8e353477579a53d"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>

    <script>
        // Update navigation functionality
        document.querySelectorAll('.portal-nav a[data-section]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = e.target.dataset.section;
                if (section) {
                    // Hide all sections first
                    document.querySelectorAll('.portal-section').forEach(s => s.style.display = 'none');
                    // Show the selected section
                    document.getElementById(`${section}-section`).style.display = 'block';
                    // Update active state in navigation
                    document.querySelectorAll('.portal-nav a').forEach(a => a.classList.remove('active'));
                    e.target.classList.add('active');
                }
            });
        });

        // Register form submission
        document.getElementById("registerForm").addEventListener("submit", function(e) {
            e.preventDefault();
            signup();
        });

        function signup() {
            const orgName = document.getElementById('orgName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            console.log('Starting signup with:', { orgName, email }); // Debug log

            firebase.auth().createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log('User created with ID:', userCredential.user.uid); // Debug log
                    // Store organization name in Firestore
                    const ngoData = {
                        organizationName: orgName,
                        email: email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    console.log('Storing NGO data:', ngoData); // Debug log
                    return db.collection('ngos').doc(userCredential.user.uid).set(ngoData);
                })
                .then(() => {
                    console.log('NGO data stored successfully'); // Debug log
                    // Sign out the user immediately after registration
                    return firebase.auth().signOut();
                })
                .then(() => {
                    console.log('User signed out after registration'); // Debug log
                    // Show success message
                    alert("Registration successful! Please login to continue.");
                    // Clear the form
                    document.getElementById("registerForm").reset();
                    // Switch to login section
                    document.getElementById('register-section').style.display = 'none';
                    document.getElementById('login-section').style.display = 'block';
                    // Update navigation
                    document.querySelector('.portal-nav a[data-section="login"]').click();
                })
                .catch((error) => {
                    console.error('Error during signup:', error); // Debug log
                    document.getElementById("error").innerText = error.message;
                });
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            console.log('Attempting login with:', email); // Debug log

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log('Login successful, user ID:', userCredential.user.uid); // Debug log
                    // Get NGO details from Firestore
                    return db.collection('ngos').doc(userCredential.user.uid).get();
                })
                .then((ngoDoc) => {
                    console.log('Retrieved NGO document:', ngoDoc.data()); // Debug log
                    if (ngoDoc.exists) {
                        const ngoData = ngoDoc.data();
                        console.log('NGO data:', ngoData); // Debug log
                        const orgName = ngoData.organizationName;
                        console.log('Organization name:', orgName); // Debug log
                        if (orgName) {
                            // Update the header with NGO name
                            document.getElementById('ngoName').textContent = `Welcome, ${orgName}`;
                            console.log('Updated header with:', orgName); // Debug log
                            // Redirect to dashboard
                            window.location.href = "ngo-dashboard.html";
                        } else {
                            console.error('Organization name not found in data'); // Debug log
                            throw new Error('Organization name not found');
                        }
                    } else {
                        console.error('NGO document does not exist'); // Debug log
                        throw new Error('NGO data not found');
                    }
                })
                .catch((error) => {
                    console.error('Error during login:', error); // Debug log
                    document.getElementById("loginError").innerText = error.message;
                });
        }

        // Check if user is already logged in
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                console.log('User is logged in, ID:', user.uid); // Debug log
                // Get NGO details and update header
                db.collection('ngos').doc(user.uid).get().then((ngoDoc) => {
                    console.log('Retrieved NGO document:', ngoDoc.data()); // Debug log
                    if (ngoDoc.exists) {
                        const ngoData = ngoDoc.data();
                        console.log('NGO data:', ngoData); // Debug log
                        const orgName = ngoData.organizationName;
                        console.log('Organization name:', orgName); // Debug log
                        if (orgName) {
                            document.getElementById('ngoName').textContent = `Welcome, ${orgName}`;
                            console.log('Updated header with:', orgName); // Debug log
                            // Only redirect to dashboard if we're not on the login/register page
                            if (!window.location.pathname.includes('ngo-portal.html')) {
                                window.location.href = "ngo-dashboard.html";
                            }
                        }
                    }
                }).catch(error => {
                    console.error('Error fetching NGO data:', error);
                });
            }
        });

        // Update logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function(event) {
            event.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                firebase.auth().signOut().then(() => {
                    window.location.reload();
                });
            }
        });

        // Dog form submission
        document.getElementById("dogForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            // Check if user is logged in
            const user = firebase.auth().currentUser;
            if (!user) {
                alert("You must be logged in as an NGO to upload.");
                document.getElementById('login-section').style.display = 'block';
                document.getElementById('dashboard-section').style.display = 'none';
                document.querySelector('.portal-nav a[data-section="login"]').click();
                return;
            }

            const dogName = document.getElementById("dogName").value;
            const breed = document.getElementById("breed").value;
            const age = parseFloat(document.getElementById("age").value);
            const weight = parseFloat(document.getElementById("weight").value);
            const healthStatus = document.getElementById("healthStatus").value;
            const file = document.getElementById("imageInput").files[0];

            if (!file) return alert("Please select an image");

            // Upload to Cloudinary
            const formData = new FormData();
            formData.append("file", file);
            formData.append("upload_preset", "pawportal");
            const cloudName = "daskt2byc";

            try {
                const uploadRes = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/image/upload`, {
                    method: "POST",
                    body: formData
                });

                const uploadData = await uploadRes.json();
                const imageUrl = uploadData.secure_url;

                // Store in Firestore
                await db.collection("dogs").add({
                    name: dogName,
                    breed: breed,
                    age: age,
                    weight: weight,
                    healthStatus: healthStatus,
                    imageUrl: imageUrl,
                    ngoId: user.uid,  // Link to logged-in NGO
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });

                alert("Dog info uploaded successfully!");
                document.getElementById("dogForm").reset();
            } catch (error) {
                console.error("Error uploading:", error);
                alert("Error uploading dog info. Please try again.");
            }
        });

        const mockDogs = [
            {
                id: 1,
                name: "Buddy",
                age: 3,
                breed: "Golden Retriever",
                description: "Friendly and playful.",
                health: "Vaccinated, no known issues.",
                image: "https://images.dog.ceo/breeds/retriever-golden/n02099601_200.jpg"
            },
            {
                id: 2,
                name: "Luna",
                age: 2,
                breed: "Labrador",
                description: "Loves to swim.",
                health: "Minor allergy to wheat.",
                image: "https://images.dog.ceo/breeds/labrador/n02099712_5642.jpg"
            },
            {
                id: 3,
                name: "Max",
                age: 4,
                breed: "Beagle",
                description: "Curious and energetic.",
                health: "Recently treated for fleas.",
                image: "https://images.dog.ceo/breeds/beagle/n02088364_11136.jpg"
            }
        ];

        function renderDogsTable() {
            const tbody = document.querySelector('#dogsTable tbody');
            tbody.innerHTML = '';
            if (mockDogs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:1.5rem;">No dogs found.</td></tr>';
                return;
            }
            mockDogs.forEach(dog => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding:0.7rem; text-align:center;">
                        <img src="${dog.image}" alt="${dog.name}" style="width:60px; height:60px; object-fit:cover; border-radius:8px;">
                    </td>
                    <td style="padding:0.7rem;">${dog.name}</td>
                    <td style="padding:0.7rem;">${dog.age}</td>
                    <td style="padding:0.7rem;">${dog.breed}</td>
                    <td style="padding:0.7rem;">${dog.health || ''}</td>
                    <td style="padding:0.7rem;">
                        <button onclick="editDog(${dog.id})" style="margin-right:0.5rem; padding:0.4rem 0.8rem; border:none; background:#1976d2; color:#fff; border-radius:4px; cursor:pointer;">Edit</button>
                        <button onclick="deleteDog(${dog.id})" style="padding:0.4rem 0.8rem; border:none; background:#e74c3c; color:#fff; border-radius:4px; cursor:pointer;">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function deleteDog(id) {
            if (confirm('Are you sure you want to delete this dog?')) {
                const index = mockDogs.findIndex(dog => dog.id === id);
                if (index !== -1) {
                    mockDogs.splice(index, 1);
                    renderDogsTable();
                }
            }
        }

        function editDog(id) {
            const dog = mockDogs.find(d => d.id === id);
            if (!dog) return;
            document.getElementById('editDogId').value = dog.id;
            document.getElementById('editDogName').value = dog.name;
            document.getElementById('editDogAge').value = dog.age;
            document.getElementById('editDogBreed').value = dog.breed;
            document.getElementById('editDogHealth').value = dog.health || '';
            document.getElementById('editDogImage').value = dog.image || '';
            document.getElementById('editDogModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editDogModal').style.display = 'none';
        }

        document.getElementById('editDogForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = parseInt(document.getElementById('editDogId').value, 10);
            const dog = mockDogs.find(d => d.id === id);
            if (dog) {
                dog.name = document.getElementById('editDogName').value;
                dog.age = parseInt(document.getElementById('editDogAge').value, 10);
                dog.breed = document.getElementById('editDogBreed').value;
                dog.health = document.getElementById('editDogHealth').value;
                dog.image = document.getElementById('editDogImage').value;
                renderDogsTable();
                closeEditModal();
            }
        });

        // Optional: Close modal when clicking outside the modal content
        document.getElementById('editDogModal').addEventListener('click', function(e) {
            if (e.target === this) closeEditModal();
        });

        // Render table when the section is shown
        document.querySelector('a[data-section="manage-dogs"]').addEventListener('click', renderDogsTable);
        document.querySelector('.portal-action[data-section="manage-dogs"]').addEventListener('click', renderDogsTable);

        const mockAdoptionRequests = [
            {
                id: 1,
                requester: "Alice Smith",
                dogId: 1,
                contact: "alice@example.com",
                status: "Pending"
            },
            {
                id: 2,
                requester: "Bob Johnson",
                dogId: 2,
                contact: "bob@example.com",
                status: "Pending"
            },
            {
                id: 3,
                requester: "Carol Lee",
                dogId: 3,
                contact: "carol@example.com",
                status: "Approved"
            }
        ];

        function getDogNameById(id) {
            const dog = mockDogs.find(d => d.id === id);
            return dog ? dog.name : "Unknown";
        }

        function renderAdoptionRequestsTable() {
            const tbody = document.querySelector('#adoptionRequestsTable tbody');
            tbody.innerHTML = '';
            if (mockAdoptionRequests.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:1.5rem;">No adoption requests found.</td></tr>';
                return;
            }
            mockAdoptionRequests.forEach(req => {
                const isPending = req.status === "Pending";
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding:0.7rem;">${req.requester}</td>
                    <td style="padding:0.7rem;">${getDogNameById(req.dogId)}</td>
                    <td style="padding:0.7rem;">${req.contact}</td>
                    <td style="padding:0.7rem;">${req.status}</td>
                    <td style="padding:0.7rem;">
                        <button onclick="updateRequestStatus(${req.id}, 'Approved')" style="margin-right:0.5rem; padding:0.4rem 0.8rem; border:none; background:#27ae60; color:#fff; border-radius:4px; cursor:pointer;" ${!isPending ? 'disabled' : ''}>Approve</button>
                        <button onclick="updateRequestStatus(${req.id}, 'Rejected')" style="padding:0.4rem 0.8rem; border:none; background:#e74c3c; color:#fff; border-radius:4px; cursor:pointer;" ${!isPending ? 'disabled' : ''}>Reject</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function updateRequestStatus(id, status) {
            const req = mockAdoptionRequests.find(r => r.id === id);
            if (req && req.status === "Pending") {
                req.status = status;
                renderAdoptionRequestsTable();
                alert(`Request has been ${status.toLowerCase()}.`);
            }
        }

        // Render table when the section is shown
        document.querySelector('a[data-section="adoption-requests"]').addEventListener('click', renderAdoptionRequestsTable);
        document.querySelector('.portal-action[data-section="adoption-requests"]').addEventListener('click', renderAdoptionRequestsTable);

        const mockOrgInfo = {
            name: "PawPortal NGO",
            email: "contact@pawportal.org",
            phone: "+1 234 567 8900",
            address: "1234 Dog Lane, Cityville",
            description: "We are dedicated to rescuing and rehoming dogs in need. Our mission is to provide loving homes for every dog."
        };

        function fillOrgInfoForm() {
            document.getElementById('orgName').value = mockOrgInfo.name;
            document.getElementById('orgEmail').value = mockOrgInfo.email;
            document.getElementById('orgPhone').value = mockOrgInfo.phone;
            document.getElementById('orgAddress').value = mockOrgInfo.address;
            document.getElementById('orgDescription').value = mockOrgInfo.description;
        }

        document.querySelector('a[data-section="update-info"]').addEventListener('click', fillOrgInfoForm);
        document.querySelector('.portal-action[data-section="update-info"]').addEventListener('click', fillOrgInfoForm);

        document.getElementById('orgInfoForm').addEventListener('submit', function(event) {
            event.preventDefault();
            mockOrgInfo.name = document.getElementById('orgName').value;
            mockOrgInfo.email = document.getElementById('orgEmail').value;
            mockOrgInfo.phone = document.getElementById('orgPhone').value;
            mockOrgInfo.address = document.getElementById('orgAddress').value;
            mockOrgInfo.description = document.getElementById('orgDescription').value;
            document.getElementById('orgSuccessMessage').style.display = 'block';
            setTimeout(() => {
                document.getElementById('orgSuccessMessage').style.display = 'none';
            }, 2000);
            // Optionally update the header name
            document.getElementById('ngoName').textContent = "Welcome, " + mockOrgInfo.name;
        });
    </script>
</body>
</html> 